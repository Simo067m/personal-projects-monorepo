{% extends "investment/base.html" %}

{% block investment_content %}
<div class="portal-container">
    <div class="investment-grid">
        
        <!-- Hero Section -->
        <div class="stat-card">
            <div class="card-label">Total Portfolio Value</div>
            <div class="stat-value">{{ "%.2f"|format(total_value_dkk) }} <span style="font-size: 18px; color: var(--text-muted);">DKK</span></div>
        </div>

        <!-- Chart Section (Full Width) -->
        <div class="chart-card">
        <div class="card-label" id="chart-label">Market History</div>
        <h2 class="card-title" id="chart-title">Select an asset to view history</h2>
        <div style="height: 300px; width: 100%; margin-top: 20px;">
        <canvas id="priceChart"></canvas>
    </div>
</div>
<div class="stat-card">
    TODO: Current holdings (This is supposed to be a title signifying that the section
    below contains individual asset tiles, update me to make me look nicer.)
</div>
        <!-- Asset Grid (Unique Bento Tiles) -->
        {% for symbol, data in holdings.items() %}
        <div class="asset-tile asset-link" 
            data-asset-id="{{ data.asset_id }}" 
            data-asset-symbol="{{ symbol }}"
            data-asset-name="{{ data.asset_name }}">
            
            <div class="asset-header">
                <div>
                    <div class="asset-symbol">{{ symbol }}</div>
                    <div class="card-label" style="font-size: 9px; margin: 0;">{{ data.asset_type }}</div>
                </div>
                <div class="asset-type-pill">{{ data.asset_currency }}</div>
            </div>

            <div class="asset-body">
                <div class="asset-price-main">
                    {% if data.asset_dkk_price %}
                        {{ "%.2f"|format(data.asset_holdings * data.asset_dkk_price) }} DKK
                    {% else %}
                        N/A
                    {% endif %}
                </div>
                <div class="asset-price-sub">
                    {{ "%.4f"|format(data.asset_holdings) }} Shares
                </div>
            </div>
            
            <div style="margin-top: 10px; border-top: 1px solid var(--border); padding-top: 10px; display: flex; justify-content: space-between; align-items: center;">
                <span class="card-label" style="margin:0;">Price</span>
                <span style="font-family: var(--mono-font); font-size: 12px;">
                    {{ "%.2f"|format(data.latest_price) if data.latest_price else "???" }}
                </span>
            </div>
        </div>
        {% endfor %}

    </div>
</div>
{% endblock %}